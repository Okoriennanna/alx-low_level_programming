#!/bin/bash

# Check if CFILE environment variable is set
if [ -z "$CFILE" ]; then
  echo "CFILE environment variable is not set."
  exit 1
fi

# Define the output file name (c)
OUTPUT_FILE="c"

# Run the C file through the preprocessor (gcc -E) and save the result to the output file
gcc -E "$CFILE" > "$OUTPUT_FILE"

# Check if the preprocessing was successful
if [ $? -eq 0 ]; then
  echo "Preprocessing completed successfully. Output saved to '$OUTPUT_FILE'."
else
  echo "Preprocessing failed."
  exit 1
fi
